/** * Devstratum JQP Graph * @version 1.5 * @author Sergey Osipov <info@devstratum.ru> * @link https://devstratum.ru * @copyright Copyright Â© 2021 Sergey Osipov. All Rights Reserved * @license MIT/X11 License * Report bugs https://github.com/devstratum/Devstratum-JQP-Graph/issues */
!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"undefined"!=typeof exports?module.exports=t(require("jquery")):t(jQuery)}(function(e){var i={title:"",description:"",unit:"",better:"",type:"number",separate:!1,labels:!0,grid_wmax:0,grid_part:5,points:[],graphs:[]};function v(t){let e=0,i=t.split(":");return i.reverse(),i[2]&&(e+=3600*Number(i[2])),i[1]&&(e+=60*Number(i[1])),i[0]&&(e+=Number(i[0])),e}function d(t){let e="";var i=Math.floor(t/60/60),r=Math.floor(t/60)-60*i,t=t%60;function n(t){let e=t<10?"0"+t:t;return e}return 0<i&&(e+=n(i)+":"),e+=n(r)+":"+n(t),e}function c(t,e,i){var r="";return r+='<div class="grid-line-crs"></div>',r+=function(e,t,i){let r=0,n="";for(var a=100/i,o=Math.round(t/i);i>r;){var s=Math.floor(r*a);let t=r*o;"time"===e.type&&(t=d(t),0===r&&(t=0)),n+='<div class="grid-line line-'+(r+1)+'" style="left:'+s+'%;"><span>'+t+"</span></div>",r++}return n}(t,e,i),"time"===t.type&&(e=d(e)),r+='<div class="grid-line-end"><span>'+e+"</span></div>"}function p(t){let e="";e+='<div class="dvstrtm-graph__header">',e+='<div class="graph-header">',t.title&&(e+='<div class="graph-header__title">'+t.title+"</div>"),e+='<div class="graph-header__info">',t.unit&&(e+='<div class="info-unit">'+t.unit+"</div>");var i=function(t){let i="";"object"==typeof t.points&&t.points.forEach(function(t){let e="";t.color&&(e="background:"+t.color+";"),t.title&&(i+='<div class="info-point">',i+='<div class="info-point__color"><span style="'+e+'"></span></div>',i+='<div class="info-point__title">'+t.title+"</div>",i+="</div>")});return i}(t);return i&&(e+='<div class="info-points">',e+=i,e+="</div>"),t.better&&(e+='<div class="info-better">'+t.better+"</div>"),e+="</div>",t.description&&(e+='<div class="graph-header__descr">'+t.description+"</div>"),e+="</div>",e+="</div>",e}function u(l,c){let p="";return"object"==typeof l.graphs&&l.graphs.forEach(function(d){if(p+='<div class="chart-block">',p+='<div class="chart-block__label"><span>'+d.label+"</span></div>",p+='<div class="chart-block__lines">',d.value){let s=999;d.value.forEach(function(i,r){let n;if("time"===l.type&&(i=v(n=i)),"number"==typeof i){var a="z-index:"+s--+";",o="width:"+function(t,e){let i=e/t*100;return i.toFixed(4)}(c,i)+"%;";let t="";d.color&&(t="background:"+d.color[r]+";");let e="position:absolute;";l.separate&&(e="position:relative;"),p+='<div class="chart-line" style="'+o+t+e+a+'">',"time"===l.type?p+="<span>"+n+"</span>":p+="<span>"+i+"</span>",p+="</div>"}})}p+="</div>",p+="</div>"}),p}function r(t,e){var i=function(i){let t=0;if(i.grid_wmax&&"time"===i.type&&(i.grid_wmax=v(i.grid_wmax)),i.grid_wmax&&"number"==typeof i.grid_wmax)t=i.grid_wmax;else{let e=0;"object"==typeof i.graphs&&i.graphs.forEach(function(t){t.value.forEach(function(t){"time"===i.type&&(t=v(t)),t>e&&(e=t)})}),t=100<e?100*Math.ceil(e/100):Math.ceil(e)}return t}(e);let r=e.grid_part;6<r&&r%2!=0&&r++;var n=c(e,i,r),a=p(e),o=u(e,i);let s="";e.labels||(s=" nolabels");let d="";6<r&&(d=" oddparts");let l="";l+='<div class="dvstrtm-graph">',l+=a,i&&(l+='<div class="dvstrtm-graph__body">',l+='<div class="graph-body'+s+'">',l+='<div class="graph-body__grid'+d+'">'+n+"</div>",l+='<div class="graph-body__chart">'+o+"</div>",l+="</div>",l+="</div>"),l+="</div>",t.append(l)}let n={init:function(t){r(this,e.extend({},i,t))}};e.fn.dvstrtm_graph=function(t){return n[t]?n[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?(e.error("dvstrtm_graph method: "+t+"not found"),!0):n.init.apply(this,arguments)}});